import csv
import numpy as np
import json

def read_E(alldates):
    csvFile = open('E.csv', 'r')
    reader = csv.reader(csvFile)
    data = []
    for item in reader:
        if item[0] in alldates:
            data.append(float(item[2]))
    return [0, max(data)]

def read_ump(alldates):
    csvFile = open('unemploy.csv', 'r')
    reader = csv.reader(csvFile)
    data = []
    for item in reader:
        if item[0] in alldates:
            data.append(float(item[1]))
    return [min(data), max(data)]

def read_mob(alldates):
    csvFile = open('mobility_truth.csv', 'r')
    reader = csv.reader(csvFile)
    data = []
    for item in reader:
        if reader.line_num == 1:
            continue
        if item[4] in alldates:
            _mob = []
            for i in range(6):
                _mob.append(float(item[5+i]))
            data.append(_mob)
    return np.array(data)

def read_new(alldates):
    csvFile = open('confirm.csv', 'r')
    reader = csv.reader(csvFile)
    rows = [row for row in reader]
    data = []
    for i in range(len(rows)):
        if rows[i][0] in alldates:
            data.append(float(rows[i][1])-float(rows[i-1][1]))
    return [min(data), max(data)]


if __name__ == "__main__":
    alldates = ['2020-04-18', '2020-04-19', '2020-04-20', '2020-04-21', '2020-04-22', '2020-04-23', '2020-04-24', '2020-04-25', '2020-04-26', '2020-04-27', '2020-04-28', '2020-04-29', '2020-04-30', '2020-05-01', '2020-05-02', '2020-05-03', '2020-05-04', '2020-05-05', '2020-05-06', '2020-05-07', '2020-05-08', '2020-05-09', '2020-05-10', '2020-05-11', '2020-05-12', '2020-05-13', '2020-05-14', '2020-05-15', '2020-05-16', '2020-05-17', '2020-05-18', '2020-05-19', '2020-05-20', '2020-05-21', '2020-05-22', '2020-05-23', '2020-05-24', '2020-05-25', '2020-05-26', '2020-05-27', '2020-05-28', '2020-05-29', '2020-05-30', '2020-05-31', '2020-06-01', '2020-06-02', '2020-06-03', '2020-06-04', '2020-06-05', '2020-06-06', '2020-06-07', '2020-06-08', '2020-06-09', '2020-06-10', '2020-06-11', '2020-06-12', '2020-06-13', '2020-06-14', '2020-06-15', '2020-06-16', '2020-06-17', '2020-06-18', '2020-06-19', '2020-06-20'] # 2
    # alldates = ['2020-05-09', '2020-05-10', '2020-05-11', '2020-05-12', '2020-05-13', '2020-05-14', '2020-05-15', '2020-05-16', '2020-05-17', '2020-05-18', '2020-05-19', '2020-05-20', '2020-05-21', '2020-05-22', '2020-05-23', '2020-05-24', '2020-05-25', '2020-05-26', '2020-05-27', '2020-05-28', '2020-05-29', '2020-05-30', '2020-05-31', '2020-06-01', '2020-06-02', '2020-06-03', '2020-06-04', '2020-06-05', '2020-06-06', '2020-06-07', '2020-06-08', '2020-06-09', '2020-06-10', '2020-06-11', '2020-06-12', '2020-06-13', '2020-06-14', '2020-06-15', '2020-06-16', '2020-06-17', '2020-06-18', '2020-06-19', '2020-06-20', '2020-06-21', '2020-06-22', '2020-06-23', '2020-06-24', '2020-06-25', '2020-06-26', '2020-06-27', '2020-06-28', '2020-06-29', '2020-06-30', '2020-07-01', '2020-07-02', '2020-07-03', '2020-07-04', '2020-07-05', '2020-07-06', '2020-07-07', '2020-07-08', '2020-07-09', '2020-07-10', '2020-07-11', '2020-07-12', '2020-07-13', '2020-07-14', '2020-07-15', '2020-07-16', '2020-07-17', '2020-07-18'] # 6

    max_min_num = {}
    mob = read_mob(alldates)
    for i in range(6):
        max_min_num['m{}'.format(i)] = [np.min(mob[:, i]), np.max(mob[:, i])]

    max_min_num['inf'] = read_E(alldates)
    max_min_num['ump'] = read_ump(alldates)
    max_min_num['new'] = read_new(alldates)

    print(max_min_num)
